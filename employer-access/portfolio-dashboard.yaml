apiVersion: v1
kind: Namespace
metadata:
  name: portfolio-dashboard
  labels:
    app: portfolio-dashboard
    project: portfolio

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: portfolio-dashboard-config
  namespace: portfolio-dashboard
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>David Vizena - DevOps Portfolio</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    </head>
    <body class="bg-gray-100 min-h-screen">
        <div class="container mx-auto px-4 py-8">
            <!-- Header -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h1 class="text-4xl font-bold text-gray-800 mb-2">David Vizena</h1>
                <h2 class="text-2xl text-blue-600 mb-4">DevOps Engineer Portfolio</h2>
                <p class="text-gray-600">Live CI/CD Pipeline Demonstration</p>
            </div>

            <!-- Pipeline Status -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- GitHub Status -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">GitHub</h3>
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Repository Status</p>
                    <a href="https://github.com/davidvizena/k8s-ci-cd" target="_blank" 
                       class="text-blue-600 hover:text-blue-800 text-sm">View Repository</a>
                </div>

                <!-- GoCD Status -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">GoCD Pipeline</h3>
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">CI/CD Status</p>
                    <a href="#" id="gocd-link" target="_blank" 
                       class="text-blue-600 hover:text-blue-800 text-sm">View Pipeline</a>
                </div>

                <!-- ArgoCD Status -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">ArgoCD</h3>
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">GitOps Status</p>
                    <a href="#" id="argocd-link" target="_blank" 
                       class="text-blue-600 hover:text-blue-800 text-sm">View GitOps</a>
                </div>

                <!-- Application Status -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-semibold text-gray-800">Application</h3>
                        <div class="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    <p class="text-sm text-gray-600 mb-2">Live Demo</p>
                    <a href="#" id="app-link" target="_blank" 
                       class="text-blue-600 hover:text-blue-800 text-sm">View App</a>
                </div>
            </div>

            <!-- Pipeline Flow -->
            <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">CI/CD Pipeline Flow</h3>
                <div class="flex flex-wrap items-center justify-center space-x-4">
                    <div class="flex flex-col items-center">
                        <div class="w-16 h-16 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold mb-2">1</div>
                        <p class="text-sm text-gray-600">GitHub Push</p>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="flex flex-col items-center">
                        <div class="w-16 h-16 bg-green-500 rounded-full flex items-center justify-center text-white font-bold mb-2">2</div>
                        <p class="text-sm text-gray-600">GoCD Build</p>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="flex flex-col items-center">
                        <div class="w-16 h-16 bg-purple-500 rounded-full flex items-center justify-center text-white font-bold mb-2">3</div>
                        <p class="text-sm text-gray-600">ArgoCD Sync</p>
                    </div>
                    <div class="text-2xl text-gray-400">‚Üí</div>
                    <div class="flex flex-col items-center">
                        <div class="w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center text-white font-bold mb-2">4</div>
                        <p class="text-sm text-gray-600">K8s Deploy</p>
                    </div>
                </div>
            </div>

            <!-- Live Metrics -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                <!-- Pipeline History -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Recent Deployments</h3>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div>
                                <p class="font-semibold text-gray-800">Deployment #42</p>
                                <p class="text-sm text-gray-600">2 minutes ago</p>
                            </div>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Success</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div>
                                <p class="font-semibold text-gray-800">Deployment #41</p>
                                <p class="text-sm text-gray-600">1 hour ago</p>
                            </div>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Success</span>
                        </div>
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg">
                            <div>
                                <p class="font-semibold text-gray-800">Deployment #40</p>
                                <p class="text-sm text-gray-600">3 hours ago</p>
                            </div>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Success</span>
                        </div>
                    </div>
                </div>

                <!-- System Health -->
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">System Health</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">Kubernetes Cluster</span>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Healthy</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">GoCD Server</span>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Running</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">ArgoCD</span>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Synced</span>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-gray-600">Application</span>
                            <span class="px-2 py-1 bg-green-500 text-white text-xs rounded-full">Live</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Technologies Used -->
            <div class="bg-white rounded-lg shadow-lg p-6">
                <h3 class="text-2xl font-bold text-gray-800 mb-6">Technologies Demonstrated</h3>
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                    <div class="text-center p-4 bg-blue-50 rounded-lg">
                        <div class="text-2xl mb-2">‚ò∏Ô∏è</div>
                        <p class="text-sm font-semibold">Kubernetes</p>
                    </div>
                    <div class="text-center p-4 bg-green-50 rounded-lg">
                        <div class="text-2xl mb-2">üéØ</div>
                        <p class="text-sm font-semibold">GoCD</p>
                    </div>
                    <div class="text-center p-4 bg-purple-50 rounded-lg">
                        <div class="text-2xl mb-2">üîÑ</div>
                        <p class="text-sm font-semibold">ArgoCD</p>
                    </div>
                    <div class="text-center p-4 bg-gray-50 rounded-lg">
                        <div class="text-2xl mb-2">üê≥</div>
                        <p class="text-sm font-semibold">Docker</p>
                    </div>
                    <div class="text-center p-4 bg-yellow-50 rounded-lg">
                        <div class="text-2xl mb-2">üìä</div>
                        <p class="text-sm font-semibold">Prometheus</p>
                    </div>
                    <div class="text-center p-4 bg-indigo-50 rounded-lg">
                        <div class="text-2xl mb-2">üîç</div>
                        <p class="text-sm font-semibold">OpenSearch</p>
                    </div>
                </div>
            </div>

            <!-- Contact Info -->
            <div class="bg-white rounded-lg shadow-lg p-6 mt-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Contact Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="text-gray-600"><strong>Email:</strong> david.vizena@example.com</p>
                        <p class="text-gray-600"><strong>LinkedIn:</strong> linkedin.com/in/davidvizena</p>
                    </div>
                    <div>
                        <p class="text-gray-600"><strong>GitHub:</strong> github.com/davidvizena</p>
                        <p class="text-gray-600"><strong>Portfolio:</strong> davidvizena.dev</p>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // Update links based on current environment
            document.addEventListener('DOMContentLoaded', function() {
                const hostname = window.location.hostname;
                const port = window.location.port;
                
                // Update GoCD link
                document.getElementById('gocd-link').href = `http://${hostname}:8153`;
                
                // Update ArgoCD link
                document.getElementById('argocd-link').href = `https://${hostname}:8080`;
                
                // Update App link
                document.getElementById('app-link').href = `http://${hostname}:3000`;
            });
        </script>
    </body>
    </html>

---
apiVersion: v1
kind: Service
metadata:
  name: portfolio-dashboard
  namespace: portfolio-dashboard
  labels:
    app: portfolio-dashboard
spec:
  type: LoadBalancer
  ports:
  - port: 80
    targetPort: 80
    name: http
  selector:
    app: portfolio-dashboard

---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: portfolio-dashboard
  namespace: portfolio-dashboard
  labels:
    app: portfolio-dashboard
spec:
  replicas: 1
  selector:
    matchLabels:
      app: portfolio-dashboard
  template:
    metadata:
      labels:
        app: portfolio-dashboard
    spec:
      containers:
      - name: portfolio-dashboard
        image: nginx:alpine
        ports:
        - containerPort: 80
        volumeMounts:
        - name: dashboard-config
          mountPath: /usr/share/nginx/html
        resources:
          requests:
            memory: "32Mi"
            cpu: "25m"
          limits:
            memory: "64Mi"
            cpu: "50m"
      volumes:
      - name: dashboard-config
        configMap:
          name: portfolio-dashboard-config
